<div class="container mx-auto px-4 py-8" data-controller="users-index">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold text-gray-700">All Users</h1>
    <div class="dropdown">
      <button type="button" data-action="users-index#toggleDropdown" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition duration-200 flex items-center">
        <i class="fas fa-plus mr-2"></i>
        Invite User
        <i class="fas fa-chevron-down ml-2 text-sm"></i>
      </button>
      <div id="inviteDropdown" data-users-index-target="inviteDropdown" class="dropdown-content">
        <div class="dropdown-divider"></div>
        <a href="#" class="dropdown-item" data-action="users-index#openAddUserModal">
          <i class="fas fa-user-plus mr-3"></i>
          <div>
            <div class="font-medium">Add a user</div>
            <div class="text-sm text-gray-400">Add a single user manually</div>
          </div>
        </a>
        <div class="dropdown-divider"></div>
        <a href="#" class="dropdown-item" data-action="users-index#openCsvModal">
          <i class="fas fa-file-upload mr-3"></i>
          <div>
            <div class="font-medium">CSV Upload</div>
            <div class="text-sm text-gray-400">Bulk import users via CSV</div>
          </div>
        </a>
      </div>
    </div>
  </div>
  <!-- Table -->
  <div class="bg-white rounded-lg shadow table-container overflow-y-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-white sticky-header">
      <tr>
        <th scope="col" class="table-header">
          Name
        </th>
        <th scope="col" class="table-header">
          Email
        </th>
        <th scope="col" class="table-header">
          Role
        </th>
        <th scope="col" class="table-header">
          Action
        </th>
      </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
      <% dummy_users = [
        { name: "Amad uddin usama", email: "amad@example.com", role: "Admin" },
        { name: "Sarah Johnson", email: "sarah.j@example.com", role: "User" },
        { name: "Michael Chen", email: "michael.c@example.com", role: "Editor" },
        { name: "Emily Davis", email: "emily.d@example.com", role: "User" },
        { name: "James Wilson", email: "james.w@example.com", role: "Admin" },
        { name: "Lisa Anderson", email: "lisa.a@example.com", role: "Editor" },
        { name: "David Taylor", email: "david.t@example.com", role: "User" },
        { name: "Emma Brown", email: "emma.b@example.com", role: "User" },
        { name: "Robert Martin", email: "robert.m@example.com", role: "Editor" },
        { name: "Emily Davis", email: "emily.d@example.com", role: "User" },
        { name: "James Wilson", email: "james.w@example.com", role: "Admin" },
        { name: "Lisa Anderson", email: "lisa.a@example.com", role: "Editor" },
        { name: "David Taylor", email: "david.t@example.com", role: "User" },
        { name: "Emma Brown", email: "emma.b@example.com", role: "User" },
        { name: "Robert Martin", email: "robert.m@example.com", role: "Editor" },
        { name: "Emily Davis", email: "emily.d@example.com", role: "User" },
        { name: "James Wilson", email: "james.w@example.com", role: "Admin" },
        { name: "Lisa Anderson", email: "lisa.a@example.com", role: "Editor" },
        { name: "David Taylor", email: "david.t@example.com", role: "User" },
        { name: "Emma Brown", email: "emma.b@example.com", role: "User" },
        { name: "Robert Martin", email: "robert.m@example.com", role: "Editor" },
        { name: "Emily Davis", email: "emily.d@example.com", role: "User" },
        { name: "James Wilson", email: "james.w@example.com", role: "Admin" },
        { name: "Lisa Anderson", email: "lisa.a@example.com", role: "Editor" },
        { name: "David Taylor", email: "david.t@example.com", role: "User" },
        { name: "Emma Brown", email: "emma.b@example.com", role: "User" },
        { name: "Robert Martin", email: "robert.m@example.com", role: "Editor" },
        { name: "Sofia Garcia", email: "sofia.g@example.com", role: "User" }
      ] %>

      <% dummy_users.each do |user| %>
        <tr class="hover:bg-gray-50 transition-colors duration-200" data-row>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="flex items-center">
              <div class="profile-circle" style="background-image: url('<%= user[:avatar_url] || '' %>')">
                <% if !user[:avatar_url] %>
                  <i class="fas fa-user text-xl"></i>
                <% end %>
              </div>
              <div class="ml-4 text-sm font-medium text-gray-900">
                <%= user[:name] %>
              </div>
            </div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
            <%= user[:email] %>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm">
              <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
                <%= user[:role] == 'Admin' ? 'bg-red-100 text-red-800' :
                                                 user[:role] == 'Editor' ? 'bg-yellow-100 text-yellow-800' :
                                                   'bg-green-100 text-green-800' %>">
                <%= user[:role] %>
              </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
            <div class="flex justify-end space-x-3">
              <button
                data-action="users-index#openEditModal"
                data-name="<%= user[:name] %>"
                data-email="<%= user[:email] %>"
                data-role="<%= user[:role] %>"
                data-avatar="<%= user[:avatar_url] %>"
                class="text-blue-600 hover:text-blue-800">
                <i class="fas fa-edit"></i>
              </button>
              <button
                data-action="users-index#openDeleteModal"
                data-name="<%= user[:name] %>"
                class="text-red-600 hover:text-red-800">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="mt-4 flex justify-center">
    <%== pagy_nav(@pagy) %>
  </div>

  <!-- Render modals -->
  <div id="inviteModal" data-users-index-target="inviteModal" class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center hidden z-[100]">
    <%= render partial: 'shared/modals/invite_user_modal' %>
  </div>
  <%= render partial: 'shared/modals/csv_upload_modal' %>
  <%= render partial: 'shared/modals/edit_user_modal' %>
  <%= render partial: 'shared/modals/delete_user_modal' %>
  <%= render partial: 'shared/modals/add_user_modal' %>
</div>